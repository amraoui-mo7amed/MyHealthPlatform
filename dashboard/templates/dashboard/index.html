{% extends "frontend/index.html" %}

{% load static i18n %}

{% block css %}
    <link rel="stylesheet" href="{% static "css/dash.css" %}" />
    <link rel="stylesheet"
          href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap4.min.css" />
{% endblock css %}

{% block extra_css %}
{% endblock extra_css %}

{% block subtitle %}
    {% trans "Dashboard" %}
{% endblock subtitle %}

{% block slider %}
{% endblock slider %}

{% block nav %}
{% endblock nav %}

{% block hero %}
{% endblock hero %}

{% block content %}
    <div class="d-flex">
        <!-- Sidebar -->
        <div id="sidebar" class='d-flex flex-column shadow hide-sidebar'>
            <div class="user-overview d-flex flex-column">
                <img src="{{ user_profile.image.url }}" alt="" />
                <h3>
                    {{ request.user.username }}
                </h3>
            </div>
            <ul id="menu">
                <li class="nav-item" data-url="{% url 'dash:home' %}">
                    <i class="fa fa-tachometer" aria-hidden="true"></i>
                    <a href="{% url "dash:home" %}" class="nav-link">{% trans "Dashboard" %}</a>
                </li>
                <!-- Admin and doctor menu -->
                {% if request.user.profile.role == 'ADMIN' or request.user.profile.role == 'DOCTOR' %}
                    <li class="nav-item" data-url="{% url 'dash:list_users' %}">
                        <i class="fa fa-users" aria-hidden="true"></i>

                        <a href="{% url "dash:list_users" %}" class="nav-link">
                            {% if request.user.profile.role == 'ADMIN' %}
                                {% trans "Users" %}
                            {% elif request.user.profile.role == 'DOCTOR' %}
                                {% trans "Patients" %}
                            {% endif %}
                        </a>
                    </li>
                {% endif %}
                {% comment %} admin menu {% endcomment %}
                {% if request.user.is_superuser %}
                    <li class="nav-item" data-url="{% url 'dash:contacts-list' %}">
                        <i class="fa fa-comment" aria-hidden="true"></i>
                        <a href="{% url "dash:contacts-list" %}" class="nav-link">{% trans "Contact Requests" %}</a>
                    </li>
                    {% comment %} Patient Menu {% endcomment %}
                {% elif request.user.profile.role == 'PATIENT' %}
                    <li class="nav-item" data-url="{% url 'patient:diet_history' %}">
                        <i class="fa fa-archive" aria-hidden="true"></i>
                        <a href="{% url "patient:diet_history" %}" class="nav-link">{% trans "Diet history" %}</a>
                    </li>
                    <div class="nt-dropdwon">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex align-items-center">
                                <i class="fa fa-cutlery fs-4 mx-2" aria-hidden="true"></i>
                                <span class="fs-5">{% trans "Nutrition" %}</span>

                            </div>
                            <button id="nt-drodown-toggel">
                                <i class="fa fa-chevron-down" aria-hidden="true"></i>
                            </button>
                        </div>
                        <ul id="nt-dropdown-list-items">
                            <li class="nav-item">
                                {% comment %} <i class="fa fa-users" aria-hidden="true"></i> {% endcomment %}
                                <a href="" class="nav-link">{% trans "Nutrition" %}</a>
                            </li>

                        </ul>
                    </div>
                    <li class="nav-item">
                        <i class="fa fa-heartbeat"></i>
                        <a class="nav-link">{% trans "Coaching" %}</a>
                    </li>
                {% elif request.user.profile.role == 'DOCTOR' %}
                    <!-- Doctor Menu -->

                {% endif %}
            </ul>
        </div>
        <div class="d-flex flex-column w-100" id='dash-page'>
            <!--Top nav-->
            <div class="dash-navbar shadow-sm">
                <div class="left">
                    <button class="menu-btn" id='menu-btn'>
                        <svg class="w-6 h-6 text-gray-800 dark:text-white"
                             aria-hidden="true"
                             xmlns="http://www.w3.org/2000/svg"
                             width="24"
                             height="24"
                             fill="none"
                             viewBox="0 0 24 24">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 7h14M5 12h14M5 17h14" />
                        </svg>
                    </button>
                </div>
                <div class="right">
                    <input type="hidden"
                           name="user_role"
                           id="user_role"
                           value="{{ request.user.profile.role }}" />
                    <button class="notification-btn">

                        <span class="bg-teal text-white">
                            {{ user_profile.notifications_count }}
                        </span>
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g id="SVGRepo_bgCarrier" stroke-width="0">
                            </g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round">
                            </g>
                            <g id="SVGRepo_iconCarrier">
                            <path d="M12.0009 5C13.4331 5 14.8066 5.50571 15.8193 6.40589C16.832 7.30606 17.4009 8.52696 17.4009 9.8C17.4009 11.7691 17.846 13.2436 18.4232 14.3279C19.1606 15.7133 19.5293 16.406 19.5088 16.5642C19.4849 16.7489 19.4544 16.7997 19.3026 16.9075C19.1725 17 18.5254 17 17.2311 17H6.77066C5.47638 17 4.82925 17 4.69916 16.9075C4.54741 16.7997 4.51692 16.7489 4.493 16.5642C4.47249 16.406 4.8412 15.7133 5.57863 14.3279C6.1558 13.2436 6.60089 11.7691 6.60089 9.8C6.60089 8.52696 7.16982 7.30606 8.18251 6.40589C9.19521 5.50571 10.5687 5 12.0009 5ZM12.0009 5V3M9.35489 20C10.0611 20.6233 10.9888 21.0016 12.0049 21.0016C13.0209 21.0016 13.9486 20.6233 14.6549 20" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            </path>
                            </g>
                        </svg>
                        <div class="dropdown-menu shadow-sm">
                            {% if notifications %}
                                {% for item in notifications %}
                                    <div class="d-flex flex-column">
                                        <div class="d-flex align-items-center">
                                            <i class="fa fa-envelope mx-2"></i>
                                            <p class='m-0'>
                                                {{ item.text|safe }}
                                            </p>
                                            <br />
                                        </div>
                                    </div>
                                {% endfor %}
                                <div class="mark-as-read">
                                    {% trans "Mark all as read" %}
                                </div>
                            {% else %}
                                <div class="text-align-center text-center">
                                    {% trans "No notifications at the moment" %}
                                </div>
                            {% endif %}
                        </div>
                    </button>
                    <a href="{% url "dash:user-profile" %}"
                       class='d-flex align-items-center'>
                        <svg viewBox="0 0 1024 1024"
                             class="icon"
                             version="1.1"
                             xmlns="http://www.w3.org/2000/svg"
                             fill="#000000">
                            <g id="SVGRepo_bgCarrier" stroke-width="0">
                            </g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round">
                            </g>
                            <g id="SVGRepo_iconCarrier">
                            <path d="M512 661.3c-117.6 0-213.3-95.7-213.3-213.3S394.4 234.7 512 234.7 725.3 330.4 725.3 448 629.6 661.3 512 661.3z m0-341.3c-70.6 0-128 57.4-128 128s57.4 128 128 128 128-57.4 128-128-57.4-128-128-128z" fill="#5F6379">
                            </path>
                            <path d="M837 862.9c-15.7 0-30.8-8.7-38.2-23.7C744.3 729.5 634.4 661.3 512 661.3s-232.3 68.1-286.8 177.9c-10.5 21.1-36.1 29.7-57.2 19.2s-29.7-36.1-19.2-57.2C217.8 662.3 357 576 512 576s294.2 86.3 363.2 225.2c10.5 21.1 1.9 46.7-19.2 57.2-6.1 3-12.6 4.5-19 4.5z" fill="#5F6379">
                            </path>
                            <path d="M512 1002.7c-270.6 0-490.7-220.1-490.7-490.7S241.4 21.3 512 21.3s490.7 220.1 490.7 490.7-220.1 490.7-490.7 490.7z m0-896c-223.5 0-405.3 181.8-405.3 405.3S288.5 917.3 512 917.3 917.3 735.5 917.3 512 735.5 106.7 512 106.7z" fill="#3688FF">
                            </path>
                            </g>
                        </svg>
                    </a>
                    <a href="{% url "user_auth:logout" %}" class='d-flex align-items-center'>
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g id="SVGRepo_bgCarrier" stroke-width="0">
                            </g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round">
                            </g>
                            <g id="SVGRepo_iconCarrier">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M2 6.5C2 4.01472 4.01472 2 6.5 2H12C14.2091 2 16 3.79086 16 6V7C16 7.55228 15.5523 8 15 8C14.4477 8 14 7.55228 14 7V6C14 4.89543 13.1046 4 12 4H6.5C5.11929 4 4 5.11929 4 6.5V17.5C4 18.8807 5.11929 20 6.5 20H12C13.1046 20 14 19.1046 14 18V17C14 16.4477 14.4477 16 15 16C15.5523 16 16 16.4477 16 17V18C16 20.2091 14.2091 22 12 22H6.5C4.01472 22 2 19.9853 2 17.5V6.5ZM18.2929 8.29289C18.6834 7.90237 19.3166 7.90237 19.7071 8.29289L22.7071 11.2929C23.0976 11.6834 23.0976 12.3166 22.7071 12.7071L19.7071 15.7071C19.3166 16.0976 18.6834 16.0976 18.2929 15.7071C17.9024 15.3166 17.9024 14.6834 18.2929 14.2929L19.5858 13L11 13C10.4477 13 10 12.5523 10 12C10 11.4477 10.4477 11 11 11L19.5858 11L18.2929 9.70711C17.9024 9.31658 17.9024 8.68342 18.2929 8.29289Z" fill="#0F1729">
                            </path>
                            </g>
                        </svg>
                    </a>
                </div>
            </div>
            <div id='content'>
                <h3 id='dashtitle'>
                    {% block dashtitle %}

                    {% endblock dashtitle %}
                </h3>
                <div id="dash" class='bg-light rounded p-2 pb-5'>
                    {% block dash %}

                    {% endblock dash %}

                </div>
                <div id="footer" class='d-flex'>
                    <span>{% trans "All rights reserved" %}</span>
                </div>
            </div>
        </div>
    </div>
    <!-- Script to indetify the active link-->
    <script src='{% static "js/dash.js" %}'>
    </script>

{% endblock content %}

{% block footer %}
{% endblock footer %}

{% block js %}
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap4.min.js"></script>
    <script src="{% static "js/notifications.js" %}?v={% now "U" %}"></script>
{% endblock js %}
