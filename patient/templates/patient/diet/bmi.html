{% extends "dashboard/index.html" %}

{% load static i18n %}

{% block subtitle %}

{% endblock subtitle %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/bmi.css' %}?v={% now 'U' %}" />
{% endblock extra_css %}


{% block content %}
    <div class="container ">
        <div class="row justify-content-center">
            <div class="col-lg-12 col-md-8 col-lg-6">
                <div class="mt-5 b" style=" background:transparent !important ">
                    <div class="card-body p-4">
                        <h3 class='form_title'>
                            {% trans "Body Mass Indicator" %}
                        </h3>
                        <div class="errorList">
                        </div>
                        <form action="{% url "patient:bmi_calculator" %}"
                              id='bmi_form'
                              method='POST'>
                            {% csrf_token %}
                            <!-- Section 1: Basic Info -->
                            <div id="section1" data-aos="fade-right" data-aos-duration="800">
                                <div class="row align-items-center">
                                    <div class="col-lg-6 col-md-2">
                                        <div class="d-flex flex-column align-items-center gap-1 w-full flex items-center justify-center">
                                            <svg id="bmiProgress"
                                                 width="200"
                                                 height="200"
                                                 viewBox="-25 -25 250 250"
                                                 version="1.1"
                                                 xmlns="http://www.w3.org/2000/svg"
                                                 style="transform:rotate(-90deg)">
                                                <circle r="90" cx="100" cy="100" fill="transparent" stroke="#e0e0e0" stroke-width="16px"></circle>
                                                <circle id="bmiProgressBar" r="90" cx="100" cy="100" stroke="#76e5b1" stroke-width="16px" stroke-linecap="round" stroke-dashoffset="565.48px" fill="transparent" stroke-dasharray="565.48px"></circle>

                                            </svg>
                                            <text id="bmiStatus" class='fw-bold fs-5'>
                                            </text>
                                        </div>
                                    </div>
                                    <div class="col-lg-6 col-md-2">
                                        <div class="form-group mb-3">
                                            <label for="height" class="form-label">
                                                {% trans "Whats your height (cm)?" %}
                                            </label>
                                            <input type="number"
                                                   class="form-control"
                                                   id="height"
                                                   name="height"
                                                   step="0.01"
                                                   value="{% if diet_request %}{{ diet_request.bmi.height|floatformat:2 }}{% elif bmi %}{{ bmi.height|floatformat:2 }}{% endif %}"
                                                   placeholder='{% trans "Enter your height in cm" %}'
                                                   required />
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="weight" class="form-label">
                                                {% trans "What's your weight (kg)?" %}
                                            </label>
                                            <input type="number"
                                                   class="form-control"
                                                   id="weight"
                                                   name="weight"
                                                   step="0.01"
                                                   value="{% if diet_request %}{{ diet_request.bmi.weight|floatformat:2 }}{% elif bmi %}{{ bmi.weight|floatformat:2 }}{% endif %}"
                                                   placeholder='{% trans "Enter your weight in kg" %}'
                                                   required />
                                        </div>
                                        <div class="form-group mb-3">
                                            <label for="bmi" class="form-label">
                                                {% trans "Your body mass index is:" %}
                                            </label>
                                            <input type="number"
                                                   class="form-control"
                                                   id="bmi"
                                                   name="bmi"
                                                   value="{% if diet_request %}{{ diet_request.bmi.bmi_value|floatformat:2 }}{% elif bmi %}{{ bmi.bmi_value|floatformat:2 }}{% endif %}"
                                                   readonly
                                                   placeholder='{% trans "BMI will be calculated here" %}' />
                                        </div>
                                    </div>
                                </div>


                                <div class="d-flex justify-content-end">
                                    <button type="button" class="btn btn-primary" onclick="showSection(2)">
                                        {% trans "Next" %}
                                    </button>
                                </div>
                            </div>

                            <!-- Section 2: Health Conditions -->
                            <div id="section2"
                                 style="display: none"
                                 data-aos="fade-left"
                                 data-aos-duration="800">
                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Select any relevant health conditions:" %}
                                    </label>
                                    <div class="form-check">
                                        <input class="form-check-input"
                                               type="checkbox"
                                               id="diabetes"
                                               name="illnesses"
                                               value="diabetes"
                                               {% if diet_request and diet_request.diabetes %}checked{% elif bmi and 'DIABETES' in bmi.sickness.values_list|join:", " %}checked{% endif %} />
                                        <label class="form-check-label" for="diabetes">
                                            {% trans "Diabetes" %}
                                        </label>
                                        <div id="diabetesFields"
                                             class="mt-3"
                                             style="display: {% if diet_request and diet_request.diabetes %}block{% else %}none{% endif %}">
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Select the type of glucose measurement:" %}
                                                </label>
                                                <select class="form-select" name="glucose_type">
                                                    <option value="mg/dl"
                                                            {% if diet_request and diet_request.diabetes.glucose_type == 'mg/dl' %}selected{% endif %}>
                                                        mg/dl
                                                    </option>
                                                    <option value="mmol/l"
                                                            {% if diet_request and diet_request.diabetes.glucose_type == 'mmol/l' %}selected{% endif %}>
                                                        mmol/l
                                                    </option>
                                                </select>
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter fasting glucose result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="fasting_glucose"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes %}{{ diet_request.diabetes.fasting_glucose|floatformat:1 }}{% endif %}"
                                                       placeholder='{% trans "Fasting glucose result" %}' />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter HbA1c result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="hba1c"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes %}{{ diet_request.diabetes.hba1c|floatformat:1 }}{% endif %}"
                                                       placeholder='{% trans "HbA1c result" %}' />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter CHOLESTEROL analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="diabetes_cholesterol"
                                                       step="1"
                                                       value="{% if diet_request and diet_request.diabetes %}{{ diet_request.diabetes.cholesterol }}{% endif %}"
                                                       placeholder='{% trans "CHOLESTEROL result" %}' />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input"
                                               type="checkbox"
                                               id="obesity"
                                               name="illnesses"
                                               value="obesity"
                                               {% if diet_request and diet_request.obesity %}checked{% elif bmi and 'OBESITY' in bmi.sickness.values_list|join:", " %}checked{% endif %} />
                                        <label class="form-check-label" for="obesity">
                                            {% trans "Obesity" %}
                                        </label>
                                        <div id="obesityFields"
                                             class="mt-3"
                                             style="display: {% if diet_request and diet_request.obesity %}block{% else %}none{% endif %}">
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter fasting glucose result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="obesity_glucose"
                                                       step="0.1"
                                                       value="{% if diet_request %}{{ diet_request.obesity.glucose }}{% endif %}"
                                                       placeholder='{% trans "Fasting glucose result" %}' />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter HDL analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="hdl"
                                                       step="0.1"
                                                       value="{% if diet_request %}{{ diet_request.obesity.hdl }}{% endif %}"
                                                       placeholder='{% trans "HDL result" %}' />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter LDL analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="ldl"
                                                       step="0.1"
                                                       value="{% if diet_request %}{{ diet_request.obesity.ldl }}{% endif %}"
                                                       placeholder='{% trans "LDL result" %}' />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter Triglycerides analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="triglycerides"
                                                       step="0.1"
                                                       value="{% if diet_request %}{{ diet_request.obesity.triglycerides }}{% endif %}"
                                                       placeholder='{% trans "Triglycerides result" %}' />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter CHOLESTEROL analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="obesity_cholesterol"
                                                       step="1"
                                                       value="{% if diet_request %}{{ diet_request.obesity.cholesterol }}{% endif %}"
                                                       placeholder='{% trans "CHOLESTEROL result" %}' />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter AC URIC analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="ac_uric"
                                                       step="1"
                                                       value="{% if diet_request %}{{ diet_request.obesity.ac_uric }}{% endif %}"
                                                       placeholder='{% trans "AC URIC result" %}' />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input"
                                               type="checkbox"
                                               id="diabetesandobesity"
                                               name="illnesses"
                                               value="diabetesandobesity"
                                               {% if diet_request and diet_request.diabetes_and_obesity %}checked{% elif bmi and 'DIABETESANDOBESITY' in bmi.sickness.values_list|join:", " %}checked{% endif %} />
                                        <label class="form-check-label" for="diabetesandobesity">
                                            {% trans "Diabetes and obesity" %}
                                        </label>
                                        <div id="diabetesandobesityFields"
                                             class="mt-3"
                                             style="display: {% if diet_request and diet_request.diabetes_and_obesity %}block{% else %}none{% endif %}">
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter fasting glucose result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_glucose"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.glucose|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter HB1AC analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_hb1ac"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.hb1ac|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter HDL analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_hdl"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.hdl|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter LDL analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_ldl"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.ldl|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter Triglycerides analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_triglycerides"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.triglycerides|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter CHOLESTEROL analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_cholesterol"
                                                       step="1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.cholesterol }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter AC URIC analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_ac_uric"
                                                       step="1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.ac_uric }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter FNS analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_fns"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.fns|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter CRP analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_crp"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.crp|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter vitamin D analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_vitamin_d"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.vitamin_d|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter B12 analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_b12"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.b12|floatformat:1 }}{% endif %}" />
                                            </div>
                                            <div class="form-group mb-3">
                                                <label class="form-label">
                                                    {% trans "Enter MAGNESIUM analysis result:" %}
                                                </label>
                                                <input type="number"
                                                       class="form-control"
                                                       name="db_magnesium"
                                                       step="0.1"
                                                       value="{% if diet_request and diet_request.diabetes_and_obesity %}{{ diet_request.diabetes_and_obesity.magnesium|floatformat:1 }}{% endif %}" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group my-3 d-flex justify-content-between">
                                        <label class="form-label">
                                            {% trans "Are you willing to lose weight?" %}
                                        </label>
                                        <div class="btn-group" role="group" aria-label="weight_loss">
                                            <input type="radio"
                                                   class="btn-check"
                                                   name="weight_loss"
                                                   id="weight_loss_yes"
                                                   value="yes"
                                                   {% if diet_request and diet_request.weight_loss %}checked{% endif %}
                                                   autocomplete="off" />
                                            <label class="btn btn-outline-primary" for="weight_loss_yes">
                                                {% trans "Yes" %}
                                            </label>
                                            <input type="radio"
                                                   class="btn-check"
                                                   name="weight_loss"
                                                   id="weight_loss_no"
                                                   value="no"
                                                   {% if diet_request and not diet_request.weight_loss %}checked{% endif %}
                                                   autocomplete="off" />
                                            <label class="btn btn-outline-primary" for="weight_loss_no">
                                                {% trans "No" %}
                                            </label>
                                        </div>
                                    </div>

                                </div>
                                <div class="d-flex justify-content-end">
                                    <button type="button" class="btn btn-secondary" onclick="showSection(1)">
                                        {% trans "Back" %}
                                    </button>
                                    <button type="button" class="btn btn-primary ms-2" onclick="showSection(3)">
                                        {% trans "Next" %}
                                    </button>
                                </div>
                            </div>

                            <!-- Section 3: Lifestyle -->
                            <div id="section3"
                                 style="display: none"
                                 data-aos="fade-up"
                                 data-aos-duration="800">
                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "How many times a day you eat?" %}
                                    </label>
                                    <select class="form-select" name="meals_per_day">
                                        <option value="1">
                                            {% trans "Once a day" %}
                                        </option>
                                        <option value="2">
                                            {% trans "Twice a day" %}
                                        </option>
                                        <option value="3">
                                            {% trans "Three times a day" %}
                                        </option>
                                        <option value="4">
                                            {% trans "Four times a day" %}
                                        </option>
                                    </select>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you eat between main meals?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Between meals">
                                        <input type="radio"
                                               class="btn-check"
                                               name="between_meals"
                                               id="between_meals_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.between_meals %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="between_meals_yes">
                                            {% trans "Yes" %}
                                        </label>

                                        <input type="radio"
                                               class="btn-check"
                                               name="between_meals"
                                               id="between_meals_no"
                                               value="no"
                                               {% if diet_request and not diet_request.between_meals %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="between_meals_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you eat sweets?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Eat sweets">
                                        <input type="radio"
                                               class="btn-check"
                                               name="sweets"
                                               id="sweets_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.sweets %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="sweets_yes">
                                            {% trans "Yes" %}
                                        </label>

                                        <input type="radio"
                                               class="btn-check"
                                               name="sweets"
                                               id="sweets_no"
                                               value="no"
                                               {% if diet_request and not diet_request.sweets %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="sweets_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>


                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you eat fast food meals?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Fast food">
                                        <input type="radio"
                                               class="btn-check"
                                               name="fast_food"
                                               id="fast_food_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.fast_food %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="fast_food_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="fast_food"
                                               id="fast_food_no"
                                               value="no"
                                               {% if diet_request and not diet_request.fast_food %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="fast_food_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Are you drinking enough water through the day?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Enough water">
                                        <input type="radio"
                                               class="btn-check"
                                               name="enough_water"
                                               id="enough_water_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.enough_water %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="enough_water_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="enough_water"
                                               id="enough_water_no"
                                               value="no"
                                               {% if diet_request and not diet_request.enough_water %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="enough_water_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you have a food allergy?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Food allergy">
                                        <input type="radio"
                                               class="btn-check"
                                               name="food_allergy"
                                               id="food_allergy_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.food_allergy %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="food_allergy_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="food_allergy"
                                               id="food_allergy_no"
                                               value="no"
                                               {% if diet_request and not diet_request.food_allergy %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="food_allergy_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                    <div id="allergyDetails"
                                         style="display: {% if diet_request and diet_request.food_allergy %}block{% else %}none{% endif %}">
                                        <div class="form-group mt-3">
                                            <label class="form-label">
                                                {% trans "If yes, this food allergy against what?" %}
                                            </label>
                                            <input type="text"
                                                   class="form-control"
                                                   name="allergy_details"
                                                   value="{% if diet_request %}{{ diet_request.allergy_details }}{% endif %}" />
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you smoke?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Smoking">
                                        <input type="radio"
                                               class="btn-check"
                                               name="smoke"
                                               id="smoke_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.smoke %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="smoke_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="smoke"
                                               id="smoke_no"
                                               value="no"
                                               {% if diet_request and not diet_request.smoke %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="smoke_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Are you suffering from depression or stress?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Depression stress">
                                        <input type="radio"
                                               class="btn-check"
                                               name="depression_stress"
                                               id="depression_stress_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.depression_stress %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="depression_stress_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="depression_stress"
                                               id="depression_stress_no"
                                               value="no"
                                               {% if diet_request and not diet_request.depression_stress %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="depression_stress_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you have a specific medication that you take?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Medication">
                                        <input type="radio"
                                               class="btn-check"
                                               name="medication"
                                               id="medication_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.medication %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="medication_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="medication"
                                               id="medication_no"
                                               value="no"
                                               {% if diet_request and not diet_request.medication %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="medication_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                    <div id="medicationDetails"
                                         style="display: {% if diet_request and diet_request.medication %}block{% else %}none{% endif %}">
                                        <div class="form-group mt-3">
                                            <label class="form-label">
                                                {% trans "If yes what is it?" %}
                                            </label>
                                            <input type="text"
                                                   class="form-control"
                                                   name="medication_details"
                                                   value="{% if diet_request %}{{ diet_request.medication_details }}{% endif %}" />
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "What time do you eat your last meal of the day?" %}
                                    </label>
                                    <input type="time"
                                           class="form-control"
                                           name="last_meal_time"
                                           value="{% if diet_request %}{{ diet_request.last_meal_time|time:'H:i' }}{% endif %}" />
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you walk at least 30 minutes a day?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Walking">
                                        <input type="radio"
                                               class="btn-check"
                                               name="walking"
                                               id="walking_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.walking %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="walking_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="walking"
                                               id="walking_no"
                                               value="no"
                                               {% if diet_request and not diet_request.walking %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="walking_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>

                                <div class="form-group mb-3">
                                    <label class="form-label">
                                        {% trans "Do you sleep at least 7 hours a night?" %}
                                    </label>
                                    <div class="btn-group" role="group" aria-label="Sleep">
                                        <input type="radio"
                                               class="btn-check"
                                               name="sleep"
                                               id="sleep_yes"
                                               value="yes"
                                               {% if diet_request and diet_request.sleep %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="sleep_yes">
                                            {% trans "Yes" %}
                                        </label>
                                        <input type="radio"
                                               class="btn-check"
                                               name="sleep"
                                               id="sleep_no"
                                               value="no"
                                               {% if diet_request and not diet_request.sleep %}checked{% endif %}
                                               autocomplete="off" />
                                        <label class="btn btn-outline-primary" for="sleep_no">
                                            {% trans "No" %}
                                        </label>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-end">
                                    <button type="button" class="btn btn-primary" onclick="showSection(4)">
                                        {% trans "Next" %}
                                    </button>
                                </div>
                            </div>

                            <!-- Section 4: AI and Doctor Assistance -->
                            <div id="section4"
                                 style="display: none"
                                 data-aos="fade-up"
                                 data-aos-duration="800">
                                <div class="d-flex align-items-center justify-content-center">
                                    <div class="form-group mb-3 m-3 d-flex flex-column diet-option">
                                        <svg viewBox="0 0 24 24"
                                             version="1.1"
                                             xmlns="http://www.w3.org/2000/svg"
                                             xmlns:xlink="http://www.w3.org/1999/xlink"
                                             fill="#000000">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0">
                                            </g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round">
                                            </g>
                                            <g id="SVGRepo_iconCarrier">
                                            <g id="-Product-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <g id="ic_fluent_bot_24_filled" fill="#212121" fill-rule="nonzero">
                                            <path d="M17.7530511,13.999921 C18.9956918,13.999921 20.0030511,15.0072804 20.0030511,16.249921 L20.0030511,17.1550008 C20.0030511,18.2486786 19.5255957,19.2878579 18.6957793,20.0002733 C17.1303315,21.344244 14.8899962,22.0010712 12,22.0010712 C9.11050247,22.0010712 6.87168436,21.3444691 5.30881727,20.0007885 C4.48019625,19.2883988 4.00354153,18.2500002 4.00354153,17.1572408 L4.00354153,16.249921 C4.00354153,15.0072804 5.01090084,13.999921 6.25354153,13.999921 L17.7530511,13.999921 Z M11.8985607,2.00734093 L12.0003312,2.00049432 C12.380027,2.00049432 12.6938222,2.2826482 12.7434846,2.64872376 L12.7503312,2.75049432 L12.7495415,3.49949432 L16.25,3.5 C17.4926407,3.5 18.5,4.50735931 18.5,5.75 L18.5,10.254591 C18.5,11.4972317 17.4926407,12.504591 16.25,12.504591 L7.75,12.504591 C6.50735931,12.504591 5.5,11.4972317 5.5,10.254591 L5.5,5.75 C5.5,4.50735931 6.50735931,3.5 7.75,3.5 L11.2495415,3.49949432 L11.2503312,2.75049432 C11.2503312,2.37079855 11.5324851,2.05700336 11.8985607,2.00734093 L12.0003312,2.00049432 L11.8985607,2.00734093 Z M9.74928905,6.5 C9.05932576,6.5 8.5,7.05932576 8.5,7.74928905 C8.5,8.43925235 9.05932576,8.99857811 9.74928905,8.99857811 C10.4392523,8.99857811 10.9985781,8.43925235 10.9985781,7.74928905 C10.9985781,7.05932576 10.4392523,6.5 9.74928905,6.5 Z M14.2420255,6.5 C13.5520622,6.5 12.9927364,7.05932576 12.9927364,7.74928905 C12.9927364,8.43925235 13.5520622,8.99857811 14.2420255,8.99857811 C14.9319888,8.99857811 15.4913145,8.43925235 15.4913145,7.74928905 C15.4913145,7.05932576 14.9319888,6.5 14.2420255,6.5 Z" id="-Color">
                                            </path>
                                            </g>
                                            </g>
                                            </g>
                                        </svg>
                                        <div class="form-check">
                                            <input type="radio"
                                                   class="form-check-input diet-type"
                                                   id="ai_bot"
                                                   name="diet_type"
                                                   value="ai"
                                                   required />
                                            <label class="form-check-label" for="ai_bot">
                                                {% trans "AI Generated Diet" %}
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group mb-3 m-3 d-flex flex-column diet-option">
                                        <svg version="1.1"
                                             id="_x32_"
                                             xmlns="http://www.w3.org/2000/svg"
                                             xmlns:xlink="http://www.w3.org/1999/xlink"
                                             viewBox="0 0 512 512"
                                             xml:space="preserve"
                                             fill="#000000">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0">
                                            </g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round">
                                            </g>
                                            <g id="SVGRepo_iconCarrier">
                                            <style type="text/css">
                                                 .st0 {
                                                      fill: #000000;
                                                 }
                                            </style>
                                            <g>
                                            <path class="st0" d="M453.047,429.766c-2.016-7.516-4.844-14.25-8.344-20.25c-6.109-10.516-14.234-18.703-23.188-25.188 c-6.703-4.891-13.891-8.844-21.172-12.266c-10.953-5.125-22.125-9.047-32.453-12.875c-10.313-3.781-19.766-7.516-27.094-11.844 c-2.672-1.594-5.094-3.25-7.172-4.969c-3.141-2.625-5.563-5.375-7.328-8.5c-1.766-3.094-2.938-6.594-3.406-10.969 c-0.313-3.125-0.453-6.047-0.453-8.844c0-8.25,1.219-15.438,2.766-22.719c4.625-5.219,8.844-11.422,12.828-18.844 c4.031-7.469,7.813-16.188,11.609-26.531c2.422-1.094,4.875-2.422,7.281-4.031c5.438-3.656,10.625-8.781,14.922-15.594 c4.328-6.813,7.797-15.281,10.141-25.719c0.656-2.906,0.984-5.781,0.984-8.625c0-5.922-1.406-11.563-3.75-16.625 c-1.625-3.5-3.719-6.719-6.125-9.625c1.234-4.563,2.734-10.688,4.063-17.875c1.844-9.969,3.375-21.922,3.375-34.5 c0-8.125-0.641-16.516-2.297-24.797c-1.234-6.203-3.047-12.359-5.625-18.266c-3.844-8.875-9.422-17.219-17.219-24.094 c-7.203-6.391-16.234-11.469-27.125-14.75c-4.609-5.5-9.375-10.188-14.297-14.094c-8.281-6.625-17-11.031-25.906-13.719 C279.188,0.969,270.172,0,261.203,0c-4.734,0-9.469,0.281-14.203,0.688c-4.438,0.406-8.141,0.875-11.438,1.422 c-4.922,0.828-8.984,1.922-12.922,3.297c-3.953,1.359-7.766,2.938-12.734,4.906c-1.891,0.734-4.375,1.844-7.375,3.344 c-5.234,2.641-11.953,6.531-19.156,11.906C172.563,33.625,160.656,45,151.344,60.406c-4.641,7.719-8.625,16.406-11.406,26.156 c-2.813,9.734-4.438,20.5-4.438,32.266c0,7.328,0.625,15.078,2,23.172c0,0.594,0.031,1.109,0.063,1.656 c0.063,1.016,0.156,2.063,0.266,3.156c0.172,1.625,0.359,3.281,0.516,4.688c0.063,0.703,0.125,1.328,0.156,1.813 c0.031,0.25,0.047,0.453,0.047,0.594l0.016,0.172v0.047v0.938l1.984,8.813c-2.859,3.125-5.328,6.625-7.25,10.453 c-2.672,5.328-4.266,11.328-4.25,17.703c-0.016,2.813,0.313,5.688,0.969,8.594l0,0c1.578,6.969,3.641,13.063,6.109,18.359 c3.719,7.953,8.422,14.156,13.641,18.797c4.031,3.625,8.344,6.25,12.609,8.219c3.797,10.297,7.594,19.016,11.594,26.469 c4,7.438,8.203,13.625,12.828,18.844c1.563,7.313,2.781,14.5,2.781,22.75c0,2.813-0.141,5.719-0.469,8.844 c-0.313,3-0.984,5.594-1.922,7.938c-1.422,3.5-3.5,6.469-6.328,9.281c-2.813,2.781-6.406,5.391-10.672,7.813 c-4.328,2.438-9.328,4.719-14.781,6.922c-9.531,3.859-20.406,7.516-31.438,11.922c-8.266,3.297-16.625,7.047-24.625,11.75 c-5.984,3.531-11.75,7.594-17.031,12.438c-7.938,7.281-14.781,16.328-19.5,27.531c-4.75,11.219-7.375,24.5-7.375,40.172 c0,2.203,0.469,4.328,1.219,6.266c0.719,1.828,1.688,3.5,2.844,5.094c2.188,2.969,5,5.609,8.453,8.172 c6.031,4.453,14.078,8.641,24.484,12.563c15.578,5.891,36.484,11.141,63.5,15C182.953,509.594,216.078,512,256,512 c34.625,0,64.109-1.797,88.953-4.781c18.625-2.234,34.641-5.125,48.234-8.453c10.188-2.484,19.016-5.203,26.609-8.078 c5.688-2.156,10.656-4.406,14.984-6.719c3.25-1.719,6.125-3.5,8.672-5.328c3.797-2.75,6.859-5.609,9.188-8.828 c1.156-1.594,2.109-3.313,2.813-5.188c0.703-1.844,1.109-3.875,1.109-5.953C456.563,447.938,455.344,438.344,453.047,429.766z M327.125,358.406l-50.063,78.156l-5.563-38.359l14.188-15.047l-9.203-15.313l38.828-20.422c1.078,1.375,2.219,2.703,3.422,3.938 C321.297,354,324.125,356.313,327.125,358.406z M188.703,264.563c-3.922-7.281-7.828-16.375-11.828-27.688l-1.313-3.688 l-3.688-1.375c-2.563-0.938-5.047-2.141-7.438-3.75c-3.594-2.422-7.031-5.719-10.156-10.656 c-3.125-4.922-5.953-11.531-7.969-20.469l0,0c-0.375-1.688-0.563-3.313-0.563-4.906c0.016-3.578,0.875-6.969,2.5-10.234 c1.344-2.688,3.234-5.234,5.5-7.547c3.844,5.813,7.016,10.406,8.172,11.563c3.766,3.75,4.297-5.109,2.516-15.063 c-3.313-18.281,5.578-10.016,28.156-53.906c45.125,10.031,124-37.938,124-37.938s0.953,21.875,16,41.938 C346.875,139.891,355,184.563,355,184.563s1.938-3.688,4.828-8.625c1.734,2.031,3.172,4.219,4.234,6.5 c1.422,3.047,2.188,6.25,2.188,9.563c0,1.594-0.188,3.25-0.563,4.938c-1.344,5.953-3.047,10.875-4.953,14.969 c-2.859,6.094-6.172,10.313-9.609,13.406c-3.469,3.094-7.141,5.094-10.969,6.5l-3.688,1.344l-1.313,3.719 c-4.016,11.313-7.922,20.406-11.844,27.703s-7.828,12.766-11.875,17.047l-1.594,1.688l-0.5,2.281 c-1.828,8.344-3.625,17.563-3.625,28.469c0,3.375,0.172,6.875,0.547,10.563c0.453,4.344,1.438,8.406,2.922,12.156 c0.078,0.188,0.156,0.344,0.234,0.531L258.625,364l-56.281-26.094c1.734-4.063,2.906-8.5,3.391-13.281l0,0 c0.391-3.688,0.547-7.188,0.547-10.563c0.016-10.906-1.797-20.156-3.625-28.5l-0.484-2.25l-1.609-1.688 C196.531,277.328,192.609,271.859,188.703,264.563z M188.25,355.906c2.922-2.344,5.641-4.984,8.016-7.938l42.922,19.922 l-9.172,15.266l14.203,15.047l-5.25,36.125l-54.766-75.453C185.594,357.922,186.938,356.938,188.25,355.906z M439.422,459.531 c-0.563,0.938-1.875,2.5-4.078,4.281c-1.938,1.563-4.516,3.281-7.781,5.063c-5.703,3.125-13.453,6.391-23.281,9.469 c-14.766,4.656-34.234,8.906-58.813,11.969c-24.563,3.063-54.234,4.969-89.469,4.969c-34.031,0-62.875-1.781-86.953-4.656 c-18.063-2.172-33.422-4.969-46.266-8.094c-9.625-2.344-17.813-4.906-24.641-7.484c-5.125-1.953-9.469-3.922-13.047-5.813 c-2.688-1.438-4.938-2.859-6.781-4.172c-2.734-1.969-4.5-3.75-5.359-4.984c-0.438-0.609-0.656-1.047-0.75-1.297 c-0.031-0.094-0.047-0.156-0.047-0.172c0-9.359,1.063-17.359,2.891-24.328c1.609-6.094,3.828-11.375,6.516-16.047 c4.719-8.172,10.906-14.609,18.25-20.016c5.516-4.063,11.656-7.547,18.188-10.656c9.781-4.656,20.375-8.438,30.781-12.266 c8.75-3.234,17.359-6.484,25.281-10.484L260.563,484l76.625-119.594c3.828,1.969,7.813,3.781,11.906,5.469 c10.281,4.219,21.234,7.859,31.797,12.063c7.922,3.125,15.641,6.547,22.641,10.625c5.266,3.063,10.141,6.469,14.469,10.391 c6.531,5.891,11.844,12.859,15.688,21.797c3.813,8.938,6.156,19.906,6.156,33.875C439.828,458.688,439.719,459.031,439.422,459.531 z">
                                            </path>
                                            <rect x="318.625" y="449.188" class="st0" width="66.875" height="11.719"></rect>
                                            </g>
                                            </g>
                                        </svg>
                                        <div class="form-check">
                                            <input type="radio"
                                                   class="form-check-input diet-type"
                                                   id="doctor"
                                                   name="diet_type"
                                                   value="doctor"
                                                   required />
                                            <label class="form-check-label" for="doctor">
                                                {% trans "Doctor Generated Diet" %}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <div class="form-group mt-3 d-none" id='submitDiv'>
                                <div class="row align-items-center">
                                    <button class="btn btn-outline-primary flex-grow-1" type='submit'>
                                        {% trans "Submit" %}
                                    </button>
                                    {% comment %} <div class="col-lg-6 col-md-12">
                                        {% trans "Get your Diet from:" %}
                                    </div>
                                    <div class="col-lg-6 col-md-12 d-flex gap-2">
                                        <button class="btn btn-outline-primary flex-grow-1" type='submit'>
                                            {% trans "AI" %}
                                        </button>
                                        <button class="btn btn-outline-primary flex-grow-1" type='submit'>
                                            {% trans "Expert" %}
                                        </button>
                                    </div> {% endcomment %}
                                </div>
                            </div>
                        </div>

                    </div>


                </div>
            </div>


        </div>

    </form>
    <!-- Section 5: Diet Plan -->
    <div id="section5"
         style="display: none"
         data-aos="fade-up"
         class="bg-white rounded container p-2"
         data-aos-duration="800">
        <div class="d-flex flex-column align-items-center justify-content-center">
            <!-- Loader -->
            <div id="loader"
                 class="spinner-border text-primary"
                 role="status"
                 style="display: none">
                <span class="visually-hidden">{% trans "Loading..." %}</span>
            </div>

            <!-- Diet Plan -->
            <div id="diet_plan" class="mt-4 w-100" style="display: none;">
                <div id="diet_plan_content">
                    {% trans "Your personalized diet plan will appear here." %}
                </div>

            </div>
            <a href="{% url "dash:home" %}" class="d-none" id="home_url">{% trans "Go Home" %}</a>

        </div>
    </div>

{% endblock content %}

{% block js %}
    <script src="{% static 'js/bmi.js' %}?v={% now "U" %}"></script>

{% endblock js %}
