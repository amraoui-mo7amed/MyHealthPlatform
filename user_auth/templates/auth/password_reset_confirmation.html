{% extends "frontend/index.html" %}

{% load static i18n %}

{% block subtitle %}
    {% trans "Password Reset confirmation" %}
{% endblock subtitle %}
{% block extra_css %}
{% endblock extra_css %}
{% block js %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Create a checkbox to toggle password visibility
        const togglePasswordCheckbox = document.createElement("input");
        togglePasswordCheckbox.type = "checkbox";
        togglePasswordCheckbox.id = "togglePasswordVisibility";
        togglePasswordCheckbox.style.marginLeft = "5px";

        // Create a label for the checkbox
        const togglePasswordLabel = document.createElement("label");
        togglePasswordLabel.htmlFor = "togglePasswordVisibility";
        togglePasswordLabel.textContent = "{% trans 'Show Passwords' %}";
        togglePasswordLabel.style.marginLeft = "5px";

        // Append the checkbox and label to the form
        const form = document.querySelector(".form");
        const submitButton = form.querySelector("button[type='submit']");
        submitButton.parentNode.insertBefore(togglePasswordCheckbox, submitButton);
        submitButton.parentNode.insertBefore(togglePasswordLabel, submitButton);

        // Add event listener to toggle password visibility
        togglePasswordCheckbox.addEventListener("change", function () {
            const passwordFields = document.querySelectorAll("#password1, #password2");
            passwordFields.forEach(field => {
                field.type = this.checked ? "text" : "password";
            });
        });
    });
</script>
{% endblock js %}

{% block slider %}
{% endblock slider %}

{% block nav %}
{% endblock nav %}

{% block content %}
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-lg-6 col-md-8 col-sm-12">
                <div class="card shadow-sm border-0">
                    <div class="errorList"></div>
                    <div class="card-body">
                        {% if success is not None %}
                            {% if success %}
                                <div class="alert alert-success">
                                    {{ message }}
                                </div>
                                <a href="{% url 'user_auth:login' %}" class="btn btn-primary w-100">
                                    {% trans "Go to Login" %}
                                </a>
                            {% else %}
                                <div class="alert alert-danger">
                                    {{ message }}
                                </div>
                            {% endif %}
                        {% else %}
                            <h5 class="text-center text-primary mb-4">
                                {% trans "Reset Your Password" %}
                            </h5>
                            <form method="POST"
                                  class='form'
                                  action="{% url 'user_auth:password_reset_confirm' token=token %}">
                                {% csrf_token %}
                                <div class="mb-3">
                                    <label for="password1" class="form-label">
                                        {% trans "New Password" %}
                                    </label>
                                    <input type="password"
                                           id="password1"
                                           name="password1"
                                           class="form-control"
                                           required />
                                </div>
                                <div class="mb-3">
                                    <label for="password2" class="form-label">
                                        {% trans "Confirm New Password" %}
                                    </label>
                                    <input type="password"
                                           id="password2"
                                           name="password2"
                                           class="form-control"
                                           required />
                                </div>
                                <button type="submit" class="btn btn-primary w-100">
                                    {% trans "Reset Password" %}
                                </button>
                            </form>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}



{% block footer %}
{% endblock footer %}
